<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Админ-панель — Центр обращений 112</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="/static/style.css" />
  <script src="/static/admin.js" defer></script>
</head>
<body>
  <header class="header">
    <div class="container header-inner">
      <div class="logo">
        <span class="logo-number">112</span>
      </div>
      <nav class="nav-desktop">
        <a href="#" class="nav-link"></a>
      </nav>
    </div>
  </header>

  <main class="admin-main">
    <div id="authOverlay" class="admin-auth-overlay">
      <div class="admin-auth-card">
        <h1 class="admin-auth-title">Вход в админ‑панель</h1>
        <p class="admin-auth-text">
          Для доступа к обращениям введите <strong>admin_secret</strong>, который используется в Telegram‑боте
          для команды <code>/admin &lt;секрет&gt;</code>.
        </p>

        <label for="authSecretInput" class="admin-label">admin_secret</label>
        <input id="authSecretInput" type="password" class="field admin-input" placeholder="Введите admin_secret" />

        <button id="authSubmitBtn" class="submit-button admin-button">
          Войти
        </button>

        <p id="authStatus" class="admin-hint"></p>
      </div>
    </div>
    <div id="adminLayout" class="container admin-container" style="display:none">
      <aside class="admin-sidebar">
        <h1 class="admin-title">Админ‑панель</h1>
        <p class="admin-subtitle">
          Обращения граждан из Telegram‑бота и сайта в одном интерфейсе.
        </p>

        <section class="admin-card admin-card-compact">
          <h2 class="admin-card-title">Текущий доступ</h2>
          <p class="admin-card-text">
            Используется секрет, который вы ввели при входе в эту панель.
          </p>
          <div class="admin-actions">
            <button id="changeSecretBtn" class="ghost-button admin-ghost-button" type="button">
              Сменить admin_secret
            </button>
          </div>
        </section>

        <section class="admin-card admin-card-compact">
          <h2 class="admin-card-title">Фильтры</h2>
          <label for="statusFilter" class="admin-label">Статус</label>
          <select id="statusFilter" class="field admin-input">
            <option value="all">Все статусы</option>
            <option value="Новая">Новые</option>
            <option value="В обработке">В обработке</option>
            <option value="Завершено">Завершенные</option>
            <option value="Отклонено">Отклоненные</option>
          </select>
          <button id="refreshBtn" class="ghost-button admin-ghost-button admin-refresh-btn" type="button">
            Обновить список
          </button>
        </section>

        <section class="admin-card admin-card-compact">
          <h2 class="admin-card-title">Экспорт</h2>
          <p class="admin-card-text">
            Загрузить CSV‑отчет по обращениям за период.
          </p>
          <div class="admin-field-row">
            <div class="admin-field-group">
              <label for="exportFrom" class="admin-label">С даты</label>
              <input id="exportFrom" type="date" class="field admin-input" />
            </div>
            <div class="admin-field-group">
              <label for="exportTo" class="admin-label">По дату</label>
              <input id="exportTo" type="date" class="field admin-input" />
            </div>
          </div>
          <button id="exportBtn" class="ghost-button admin-ghost-button" type="button">
            Скачать CSV
          </button>
          <p class="admin-hint small">
            Используется тот же <strong>admin_secret</strong>, что и при входе.
          </p>
        </section>
      </aside>

      <section class="admin-content">
        <div class="admin-list-card">
          <div class="admin-list-header">
            <div>
              <h2 class="admin-list-title">Обращения</h2>
              <p id="issuesCounter" class="admin-list-subtitle">Заявок пока нет</p>
            </div>
            <div id="listStatus" class="admin-list-status"></div>
          </div>

          <div class="admin-table-wrapper">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Статус</th>
                  <th>Район</th>
                  <th>Категория</th>
                  <th>Текст</th>
                  <th>Создано</th>
                </tr>
              </thead>
              <tbody id="issuesTableBody">
              </tbody>
            </table>
            <div id="emptyState" class="admin-empty-state">
              <p class="admin-empty-title">Нет данных</p>
              <p class="admin-empty-text">
                Либо нет заявок с выбранным статусом, либо не задан секрет.
              </p>
            </div>
          </div>
        </div>

        <div class="admin-details-card" id="detailsCard">
          <div class="admin-details-header">
            <div>
              <p class="admin-details-label">Заявка</p>
              <h2 id="detailsTitle" class="admin-details-title">Не выбрана</h2>
            </div>
            <span id="detailsStatusPill" class="status-pill status-pill-muted">—</span>
          </div>

          <div id="detailsBody" class="admin-details-body admin-details-body-empty">
            <p class="admin-details-placeholder">
              Выберите обращение в списке слева, чтобы посмотреть детали и изменить статус.
            </p>
          </div>
        </div>
      </section>
    </div>
  </main>
</body>
</html>
